/*!
 * Strve.js v1.1.5
 * (c) 2021-2021 Vam,maomincoding
 * Released under the MIT License.
 */
const e={_el:null,_data:null,_template:null,oldTree:null,isMounted:!1};function t(t,n){if(e._data=n.data,e._template=n.template,e._el=t,!t)throw Error("[Strve warn]:Please set el property!");if(!e._template().type)throw Error("[Strve warn]:Multiple root nodes returned from render function. Render function should return a single root node.");h(e._template(),t)}async function n(t){"function"==typeof t&&(await t(),h(e._template(),e._el))}const r=new RegExp("{(.+?)}");function o(e,t){try{return t.split(".").reduce(((e,t)=>e[t]),e)}catch(e){return}}function l({el:e,key:t,oldProps:n}){e.removeAttribute(t),t.startsWith("on")&&e.removeEventListener(t.split("on")[1],n[t],!1)}function i(e,t){for(let n=0;n<Object.keys(t).length;n++){const r=Object.keys(t)[n].toString();r.startsWith("on")&&e.addEventListener(r.split("on")[1],t[r],!1)}}function s(t,n,l){if(l&&(t=t.replace(r,l)),r.test(t)){const l=r.exec(t)[1];e._data.hasOwnProperty(l)?s(t,n,e._data[l]):s(t,n,o(e._data,l.toString()))}else n.textContent=t.toString()}function p(t,n,o){if(t.type){const l=document.createElement(t.type);if(t.el=l,t.props){i(l,t.props);for(const n in t.props){if("string"==typeof t.props[n]&&r.test(t.props[n])){const o=r.exec(t.props[n])[1];t.props[n]=t.props[n].replace(r,e._data[o])}l.setAttribute(n,t.props[n])}}t.children&&("string"==typeof t.children[0]?s(t.children[0],l):"number"==typeof t.children[0]?s(t.children[0].toString(),l):Array.isArray(t.children[0])?t.children[0].forEach((e=>{p(e,l)})):t.children.forEach((e=>{p(e,l)}))),o?n.insertBefore(l,o):n.appendChild(l)}}function c(t,n){if(t.type!==n.type){const e=t.el.parentNode,r=t.el.nextSibling;return e.removeChild(t.el),void p(n,e,r)}const h=n.el=t.el,a=t.props||{},f=n.props||{};i(h,f);for(const t in f){let n=f[t],i=a[t];if(null!==n){if(n!==i){if(r.test(n)){const t=r.exec(n)[1];n=e._data.hasOwnProperty(t)?e._data[t]:o(e._data,t.toString())}h.setAttribute(t,n)}}else l({el:h,key:t,oldProps:a})}for(const e in a)e in f||l({el:h,key:e,oldProps:a});const u=t.children,d=n.children;if("string"==typeof d[0])s(d[0],h);else if("number"==typeof d[0])s(d[0].toString(),h);else if("string"!==u[0])if(Array.isArray(u[0])&&Array.isArray(d[0])){for(let e=0;e<Math.min(u[0].length,d[0].length);e++)c(u[0][e],d[0][e]);d[0].length>u[0].length?d[0].slice(u[0].length).forEach((e=>p(e,h))):u[0].length>d[0].length&&u[0].slice(d[0].length).forEach((e=>{h.removeChild(e.el)}))}else{for(let e=0;e<Math.min(u.length,d.length);e++)c(u[e],d[e]);d.length>u.length?d.slice(u.length).forEach((e=>p(e,h))):u.length>d.length&&u.slice(d.length).forEach((e=>{h.removeChild(e.el)}))}else h.innerHTML="",d.forEach((e=>p(e,h)))}function h(t,n){if(e.isMounted){const n=t;c(e.oldTree,n),e.oldTree=n}else p(e.oldTree=t,document.querySelector(n)),e.isMounted=!0}let a=function(e,t,n,r){let o;t[0]=0;for(let l=1;l<t.length;l++){let i=t[l++],s=t[l]?(t[0]|=i?1:2,n[t[l++]]):t[++l];s&&(3===i?r[0]=s:4===i?r[1]=Object.assign(r[1]||{},s):5===i?(r[1]=r[1]||{})[t[++l]]=s:6===i?r[1][t[++l]]+=s+"":i?(o=e.apply(s,a(e,s,n,["",null])),r.push(o),s[0]?t[0]|=2:(t[l-2]=0,t[l]=o)):r.push(s))}return r},f=new Map;const u=function(e){let t=f.get(this);return t||(t=new Map,f.set(this,t)),(t=a(this,t.get(e)||(t.set(e,t=function(e){let t,n,r,o=1,l="",i="",s=[0],p=0;for(r=function(e){1===o&&(e||(l=l.replace(/^\s*\n\s*|\s*\n\s*$/g,"")))?s.push(0,e,l):3===o&&(e||l)?(s.push(3,e,l),o=2):2===o&&"..."===l&&e?s.push(4,e,0):2===o&&l&&!e?s.push(5,0,!0,l):o>=5&&((l||!e&&5===o)&&(s.push(o,0,l,n),o=6),e&&(s.push(o,e,0,n),o=6)),l=""};p<e.length;p++){p&&(1===o&&r(),r(p));for(let c=0;c<e[p].length;c++)t=e[p][c],1===o?"<"===t?(r(),s=[s],o=3):l+=t:4===o?"--"===l&&">"===t?(o=1,l=""):l=t+l[0]:i?t===i?i="":l+=t:'"'===t||"'"===t?i=t:">"===t?(r(),o=1):o&&("="===t?(o=5,n=l,l=""):"/"===t&&(o<5||">"===e[p][c+1])?(r(),3===o&&(s=s[0]),o=s,(s=s[0]).push(2,0,o),o=0):" "===t||"\t"===t||"\n"===t||"\r"===t?(r(),o=2):l+=t),3===o&&"!--"===l&&(o=4,s=s[0])}return r(),s}(e)),t),arguments,[])).length>1?t:t[0]}.bind((function(e,t,...n){return{type:e,props:t,children:n}}));export{t as Strve,u as render,n as updateView};
