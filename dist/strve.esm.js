const e=M("html,body,base,head,link,meta,style,title,address,article,aside,footer,header,h1,h2,h3,h4,h5,h6,hgroup,nav,section,div,dd,dl,dt,figcaption,figure,picture,hr,img,li,main,ol,p,pre,ul,a,b,abbr,bdi,bdo,br,cite,code,data,dfn,em,i,kbd,mark,q,rp,rt,rtc,ruby,s,samp,small,span,strong,sub,sup,time,u,var,wbr,area,audio,map,track,video,embed,object,param,source,canvas,script,noscript,del,ins,caption,col,colgroup,table,thead,tbody,td,th,tr,button,datalist,fieldset,form,input,label,legend,meter,optgroup,option,output,progress,select,textarea,details,dialog,menu,menuitem,summary,content,element,shadow,template,blockquote,iframe,tfoot"),t={svg:"http://www.w3.org/2000/svg",math:"http://www.w3.org/1998/Math/MathML"},n="http://www.w3.org/1999/xlink",r=M("svg,animate,circle,clippath,cursor,image,defs,desc,ellipse,filter,font-faceforeignobject,g,glyph,line,marker,mask,missing-glyph,path,pattern,polygon,polyline,rect,switch,symbol,text,textpath,tspan,use,view,feBlend,feColorMatrix,feComponentTransfer,feComposite,feConvolveMatrix,feDiffuseLighting,feDisplacementMap,feFlood,feGaussianBlur,feImage,feMerge,feMorphology,feOffset,feSpecularLighting,feTile,feTurbulence,feDistantLight,fePointLight,feSpotLight,linearGradient,stop,radialGradient,animateTransform,animateMotion");function o(e){return-1!==["object","array","function","regexp","date","math"].indexOf(x(e))}function i(e,t){for(let n in t)e.style[n]=t[n]}function l(e,t,n){const r=new CustomEvent(e,t);r&&document.querySelector(n).dispatchEvent(r)}function s({el:e,key:t,oldProps:r}){var o;if(c(t)?e.removeAttributeNS(n,c(o=t)?o.slice(6,o.length):""):e.removeAttribute(t),t.startsWith("on")){const n=t.split("on")[1][0].toLowerCase()+t.split("on")[1].substring(1);e.removeEventListener(n,r[t],!1)}}function c(e){return":"===e.charAt(5)&&"xlink"===e.slice(0,5)}function a(n){return e(n)?document.createElement(n):r(n)?(o=function(e){return r(e)?"svg":"math"===e?"math":void 0}(n),i=n,document.createElementNS(t[o],i)):"fragment"===n?document.createDocumentFragment():"comment"===n?document.createComment("comment"):"textnode"===n?document.createTextNode(""):void 0;var o,i}function u(e,t,n){if(1!==e.length||o(e[0]))if(e.length>1&&!j(e)){f(e.join().replace(/,/g,""),n)}else!o(e[0])||e[0].tag||j(e[0])?t():f(e[0],n);else f(e,n)}function f(e,t){o(e)?"function"===x(e)||"regexp"===x(e)||"array"===x(e)?t.textContent=String(e):t.textContent=JSON.stringify(e):t.textContent=e?e.toString():String(e)}function p(e,t,r){if(e.tag){const o=a(e.tag);if(e.el=o,e.props){!function(e,t){for(let n=0;n<Object.keys(t).length;n++){const r=Object.keys(t)[n].toString();if(r.startsWith("on")){const n=r.split("on")[1][0].toLowerCase()+r.split("on")[1].substring(1);e.addEventListener(n,t[r],!1)}}}(o,e.props);for(const t in e.props)e.props.hasOwnProperty(t)&&("function"!==x(e.props[t])&&(c(t)?o.setAttributeNS(n,t,e.props[t]):o.setAttribute(t,e.props[t])),"object"===x(e.props[t])&&i(o,e.props[t]))}if(e.children){u(e.children,(function(){"array"===x(e.children[0])?e.children[0].forEach((e=>{p(e,o)})):"array"===x(e.children)&&e.children.forEach((e=>{p(e,o)}))}),o)}r?t.insertBefore(o,r):t.appendChild(o)}}function h(e,t,r){if(e.tag!==t.tag){const n=e.el.parentNode,r=e.el.nextSibling;n.removeChild(e.el),p(t,n,r)}else if(e&&t&&j(e)&&j(t)){const o=t.el=e.el,l=e.props||{},a=t.props||{};for(const e in a){let[t,r]=[a[e],l[e]];if(t!==r)if(null!==t){if("function"!==x(t))o[e]&&(o[e]=t),c(e)?o.setAttributeNS(n,e,t):o.setAttribute(e,t),"object"===x(t)&&i(o,t);else if(e.startsWith("on")){const n=e.split("on")[1][0].toLowerCase()+e.split("on")[1].substring(1);o.addEventListener(n,t,!1)}}else s({el:o,key:e,oldProps:l})}for(const e in l)e in a||s({el:o,key:e,oldProps:l});const[f,h,g,m]=[e.children&&e.children[0],t.children&&t.children[0],e.children,t.children];JSON.stringify(g)!==JSON.stringify(m)&&u(m,(function(){"array"===x(f)&&"array"===x(h)?d(f,h,o,r):"array"!==x(f)&&"array"===x(h)?(o.innerHTML="",h.forEach((e=>p(e,o)))):d(g,m,o,r)}),o)}}function d(e,t,n,r){if("useFkey"===r)for(let o=1;o<=Math.max(e.length,t.length);o++)e[e.length-o]?t[t.length-o]?h(e[e.length-o],t[t.length-o],r):n.removeChild(e[e.length-o].el):p(t[t.length-o],e[e.length-1].el.parentNode,e[0].el);else{for(let n=0;n<Math.min(e.length,t.length);n++)h(e[n],t[n],r);t.length>e.length?t.slice(e.length).forEach((e=>p(e,n))):e.length>t.length&&e.slice(t.length).forEach((e=>{n.removeChild(e.el)}))}}function g(e){return{tag:"fragment",props:null,children:e}}function m(e,t,n){if(v.isMounted){let t=null;t=e.tag?e:g(e),h(v.oldTree,t,n),v.oldTree=t}else{const n=e.tag?e:g(e);p(n,document.querySelector(t)),v.oldTree=n,v.isMounted=!0}}function b(e,t){if("function"===x(e)&&"undefined"!==x(Promise))return Promise.resolve().then((()=>{e()})).then((()=>{const e=C(v._template());"useRouter"===t?(document.querySelector(v._el).innerHTML="",p(v.oldTree=e,document.querySelector(v._el))):m(e,v._el,t)})).catch((e=>console.error(e)))}const y="2.3.4",v={_el:null,_template:null,oldTree:null,isMounted:!1,observer:null};function w(e,t,n){if(e){const r=document.querySelector(e);return null===v.observer&&(v.observer=new MutationObserver(n)),{start(){v.observer.observe(r,t)},stop(){let e=v.observer.takeRecords();v.observer.disconnect(),"array"===x(e)&&0===e.length&&(v.observer=null)}}}console.error("[Strve warn]: Please check whether the element exists or need to put watchDOMChange on the mount node.")}function x(e){return Object.prototype.toString.call(e).match(/\[object (.+?)\]/)[1].toLowerCase()}const S=M("function,regexp,date,math,undefined,null,boolean,string,number,symbol,bigInt");function M(e){const t=Object.create(null),n=e.split(",");for(let e=0;e<n.length;e++)t[n[e]]=!0;return function(e){return t[e]}}function O(e){if(e.hasOwnProperty("tag")&&e.hasOwnProperty("props")&&e.hasOwnProperty("children"))return!0}function j(e){if("array"===x(e)){for(let t=0;t<e.length;t++)if(O(e[t]))return!0}else if("object"===x(e))return O(e)}function k(e){for(let t=0;t<e.length;t++){const n=e[t];"array"===x(n)&&k(n),""===n?e.splice(t,1,{tag:"comment",children:[],props:null}):S(x(n))?e.splice(t,1,{tag:"textnode",children:[n],props:null}):n.children&&j(n.children)&&k(n.children)}return e}function C(e){return"array"===x(e)?k(e):j(e)&&"object"===x(e)?(e.children=k(e.children),e):{tag:"textnode",children:[e],props:null}}const L=e=>("object"==typeof e||"function"==typeof e)&&null!==e;function E(e,t=new WeakMap){if(e.constructor===Date)return new Date(e);if(e.constructor===RegExp)return new RegExp(e);if(t.has(e))return t.get(e);let n=Object.getOwnPropertyDescriptors(e),r=Object.create(Object.getPrototypeOf(e),n);t.set(e,r);for(let n of Reflect.ownKeys(e))r[n]=L(e[n])&&"function"!=typeof e[n]?E(e[n],t):e[n];return r}function P(e,t){if(e){v._el=e,v._template=t;m(C(t()),e)}else console.error("[Strve warn]: There must be a mount element node.")}let T=function(e,t,n,r){let o;t[0]=0;for(let i=1;i<t.length;i++){let l=t[i++],s=t[i]?(t[0]|=l?1:2,n[t[i++]]):t[++i];void 0===s&&null===s||(3===l?r[0]=s:4===l?r[1]=Object.assign(r[1]||{},s):5===l?(r[1]=r[1]||{})[t[++i]]=s:6===l?r[1][t[++i]]+=s+"":l?(o=e.apply(s,T(e,s,n,["",null])),r.push(o),s[0]?t[0]|=2:(t[i-2]=0,t[i]=o)):r.push(s))}return r},N=new Map;const D=function(e){let t=N.get(this);return t||(t=new Map,N.set(this,t)),(t=T(this,t.get(e)||(t.set(e,t=function(e){let t,n,r,o=1,i="",l="",s=[0],c=0;for(r=function(e){1===o&&(e||(i=i.replace(/^\s*\n\s*|\s*\n\s*$/g,"")))?s.push(0,e,i):3===o&&(e||i)?(s.push(3,e,i),o=2):2===o&&"..."===i&&e?s.push(4,e,0):2===o&&i&&!e?s.push(5,0,!0,i):o>=5&&((i||!e&&5===o)&&(s.push(o,0,i,n),o=6),e&&(s.push(o,e,0,n),o=6)),i=""};c<e.length;c++){c&&(1===o&&r(),r(c));for(let a=0;a<e[c].length;a++)t=e[c][a],1===o?"<"===t?(r(),s=[s],o=3):i+=t:4===o?"--"===i&&">"===t?(o=1,i=""):i=t+i[0]:l?t===l?l="":i+=t:'"'===t||"'"===t?l=t:">"===t?(r(),o=1):o&&("="===t?(o=5,n=i,i=""):"/"===t&&(o<5||">"===e[c][a+1])?(r(),3===o&&(s=s[0]),o=s,(s=s[0]).push(2,0,o),o=0):" "===t||"\t"===t||"\n"===t||"\r"===t?(r(),o=2):i+=t),3===o&&"!--"===i&&(o=4,s=s[0])}return r(),s}(e)),t),arguments,[])).length>1?t:t[0]}.bind((function(e,t,...n){return{tag:e,props:t,children:n}}));export{P as Strve,E as deepCloneData,l as emitEvent,D as render,y as strveVersion,b as updateView,w as watchDOMChange};
