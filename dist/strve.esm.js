var e={_el:null,_data:null,_template:null,oldTree:null,isMounted:!1};const t=new RegExp("{(.+?)}");function n(e,t){try{return t.split(".").reduce(((e,t)=>e[t]),e)}catch(e){return}}function r({el:e,key:t,oldProps:n}){e.removeAttribute(t),t.startsWith("on")&&e.removeEventListener(t.split("on")[1],n[t],!1)}function o(e,t){for(let n=0;n<Object.keys(t).length;n++){const r=Object.keys(t)[n].toString();r.startsWith("on")&&e.addEventListener(r.split("on")[1],t[r],!1)}}function l(e,n,r){e=e.replace(t,r),t.test(e)?s(e,n):n.textContent=String(e)}function s(r,o){if(t.test(r)){const s=t.exec(r)[1];e._data.hasOwnProperty(s)?l(r,o,e._data[s]):l(r,o,n(e._data,s.toString()))}else o.textContent=String(r)}function i(n,r,l){if(n.type){const p=document.createElement(n.type);if(n.el=p,n.props){o(p,n.props);for(const r in n.props){if("string"==typeof n.props[r]&&t.test(n.props[r])){const o=t.exec(n.props[r])[1];n.props[r]=n.props[r].replace(t,e._data[o])}p.setAttribute(r,n.props[r])}}n.children&&("string"==typeof n.children[0]?s(n.children[0],p):Array.isArray(n.children[0])?n.children[0].forEach((e=>{i(e,p)})):n.children.forEach((e=>{i(e,p)}))),l?r.insertBefore(p,l):r.appendChild(p)}}function p(l,c){if(l.type!==c.type){const e=l.el.parentNode,t=l.el.nextSibling;return e.removeChild(l.el),void i(c,e,t)}const a=c.el=l.el,h=l.props||{},f=c.props||{};o(a,f);for(const o in f){let l=f[o],s=h[o];if(null!==l){if(l!==s){if(t.test(l)){const r=t.exec(l)[1];l=e._data.hasOwnProperty(r)?e._data[r]:n(e._data,r.toString())}a.setAttribute(o,l)}}else r({el:a,key:o,oldProps:h})}for(const e in h)e in f||r({el:a,key:e,oldProps:h});const u=l.children,d=c.children;if("string"==typeof d[0])s(d[0],a);else if("string"!==u[0])if(Array.isArray(u[0])&&Array.isArray(d[0])){for(let e=0;e<Math.min(u[0].length,d[0].length);e++)p(u[0][e],d[0][e]);d[0].length>u[0].length?d[0].slice(u[0].length).forEach((e=>i(e,a))):u[0].length>d[0].length&&u[0].slice(d[0].length).forEach((e=>{a.removeChild(e.el)}))}else{for(let e=0;e<Math.min(u.length,d.length);e++)p(u[e],d[e]);d.length>u.length?d.slice(u.length).forEach((e=>i(e,a))):u.length>d.length&&u.slice(d.length).forEach((e=>{a.removeChild(e.el)}))}else a.innerHTML="",d.forEach((e=>i(e,a)))}function c(t,n){if(e.isMounted){const n=t;p(e.oldTree,n),e.oldTree=n}else i(e.oldTree=t,document.querySelector(n)),e.isMounted=!0}function a(t,n){if(e._data=n.data,e._template=n.template,e._el=t,!t)throw Error("[Strve warn]:Please set el property!");if(!e._template().type)throw Error("[Strve warn]:Multiple root nodes returned from render function. Render function should return a single root node.");c(e._template(),t)}async function h(t){"function"==typeof t&&(await t(),c(e._template(),e._el))}let f=function(e,t,n,r){let o;t[0]=0;for(let l=1;l<t.length;l++){let s=t[l++],i=t[l]?(t[0]|=s?1:2,n[t[l++]]):t[++l];i&&(3===s?r[0]=i:4===s?r[1]=Object.assign(r[1]||{},i):5===s?(r[1]=r[1]||{})[t[++l]]=i:6===s?r[1][t[++l]]+=i+"":s?(o=e.apply(i,f(e,i,n,["",null])),r.push(o),i[0]?t[0]|=2:(t[l-2]=0,t[l]=o)):r.push(i))}return r},u=new Map;const d=function(e){let t=u.get(this);return t||(t=new Map,u.set(this,t)),(t=f(this,t.get(e)||(t.set(e,t=function(e){let t,n,r,o=1,l="",s="",i=[0],p=0;for(r=function(e){1===o&&(e||(l=l.replace(/^\s*\n\s*|\s*\n\s*$/g,"")))?i.push(0,e,l):3===o&&(e||l)?(i.push(3,e,l),o=2):2===o&&"..."===l&&e?i.push(4,e,0):2===o&&l&&!e?i.push(5,0,!0,l):o>=5&&((l||!e&&5===o)&&(i.push(o,0,l,n),o=6),e&&(i.push(o,e,0,n),o=6)),l=""};p<e.length;p++){p&&(1===o&&r(),r(p));for(let c=0;c<e[p].length;c++)t=e[p][c],1===o?"<"===t?(r(),i=[i],o=3):l+=t:4===o?"--"===l&&">"===t?(o=1,l=""):l=t+l[0]:s?t===s?s="":l+=t:'"'===t||"'"===t?s=t:">"===t?(r(),o=1):o&&("="===t?(o=5,n=l,l=""):"/"===t&&(o<5||">"===e[p][c+1])?(r(),3===o&&(i=i[0]),o=i,(i=i[0]).push(2,0,o),o=0):" "===t||"\t"===t||"\n"===t||"\r"===t?(r(),o=2):l+=t),3===o&&"!--"===l&&(o=4,i=i[0])}return r(),i}(e)),t),arguments,[])).length>1?t:t[0]}.bind((function(e,t,...n){return{type:e,props:t,children:n}}));export{a as Strve,d as render,h as updateView};
